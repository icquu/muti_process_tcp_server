CDN访问流程：

用户访问 www.example.com
|
|----> DNS解析 www.example.com
|      |
|      |----> 智能DNS返回最优或最近的CDN节点IP
|             |
|             |----> 用户访问该IP
|                    |
|                    |----> CDN节点检查本地缓存是否有该资源
|                           |
|                           |----> 有，则直接返回给用户
|                           |
|                           |----> 没有，则向源站回源获取资源，并更新本地缓存，然后返回给用户

DNS劫持示意：

用户访问 www.example.com
|
|----> DNS解析 www.example.com
|      |
|      |----> DNS服务器返回正常IP地址
|             |
|             |----> 用户访问正常IP地址
|
|----> DNS解析 www.example.com
|      |
|      |----> DNS服务器被攻击者篡改或控制
|             |
|             |----> DNS服务器返回恶意IP地址
|                    |
|                    |----> 用户访问恶意IP地址

防止或检测DNS劫持的方法有以下几种：

使用复杂的密码重置路由器的默认密码，以防止攻击者通过路由器篡改DNS设置。
使用双因素身份验证和修补漏洞，以保护DNS注册器和服务器不被攻击者控制。
远离不受信任的网站和下载，以避免恶意代码修改DNS设置。
修改hosts文件，将常用的域名和IP地址直接对应，避免查询DNS服务器。
使用SSH加密代理或科学上网工具，在加密代理里进行远程DNS解析，绕过本地DNS服务器。
准备多个域名，一旦发生DNS劫持，用户还可以访问其他域名。
